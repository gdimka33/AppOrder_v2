from База_данных.БД_соединение import выполнить_запрос
from logger import logger

def заполнить_справочник_должностей():
    """
    Заполняет справочник должностей начальными данными.
    Каждая должность может относиться к одной или нескольким категориям:
    - офицер: для аттестованных сотрудников
    - работник: для вольнонаемных работников
    - курсант: для переменного состава
    """
    должности = [
        ('начальник института', '["офицер"]'),
        ('заместитель начальника института по учебной работе', '["офицер"]'),
        ('заместитель начальника института по служебно-боевой подготовке', '["офицер"]'),
        ('заместитель начальника института по тылу', '["офицер"]'),
        ('заместитель начальника института по кадрам', '["офицер"]'),
        ('начальник', '["офицер"]'),
        ('заместитель начальника', '["офицер"]'),
        ('профессор', '["офицер", "работник"]'),
        ('доцент', '["офицер", "работник"]'),
        ('старший преподаватель', '["офицер", "работник"]'),
        ('преподаватель', '["офицер", "работник"]'),
        ('старший преподаватель-методист', '["офицер", "работник"]'),
        ('преподаватель-методист', '["офицер", "работник"]'),
        ('начальник курса', '["офицер"]'),
        ('старший инспектор', '["офицер"]'),
        ('ученый секретарь', '["офицер"]'),
        ('инспектор', '["офицер"]'),
        ('младший инспектор', '["офицер"]'),
        ('старший оперативный дежурный', '["офицер"]'),
        ('контролер контрольно-пропускного пункта', '["офицер", "курсант"]'),
        ('заведующий складом вооружения', '["офицер"]'),
        ('комендант зданий', '["офицер"]'),
        ('дирижер оркестра', '["офицер"]'),
        ('заместитель начальника отдела – начальник отделения', '["офицер"]'),
        ('старший инженер', '["офицер"]'),
        ('инженер', '["офицер"]'),
        ('заведующий', '["офицер"]'),
        ('начальник кабинета', '["офицер"]'),
        ('старший преподаватель -методист', '["офицер"]'),
        ('врач-терапевт', '["офицер", "работник"]'),
        ('фельдшер', '["офицер", "работник"]'),
        ('медсестра', '["работник"]'),
        ('фармацевт', '["работник"]'),
        ('инженер-программист', '["работник"]'),
        ('техник', '["работник"]'),
        ('электромонтер', '["работник"]'),
        ('слесарь-ремонтник', '["работник"]'),
        ('столяр', '["работник"]'),
        ('маляр', '["работник"]'),
        ('повар', '["работник"]'),
        ('водитель', '["работник"]'),
        ('водитель-сотрудник', '["офицер"]'),
        ('документовед', '["работник"]'),
        ('делопроизводитель', '["работник"]'),
        ('библиотекарь', '["работник"]'),
        ('библиограф', '["работник"]'),
        ('диспетчер', '["работник"]'),
        ('старший редактор', '["офицер"]'),
        ('редактор', '["офицер"]'),
        ('старший бухгалтер', '["офицер"]'),
        ('бухгалтер', '["офицер"]'),
        ('курсант', '["курсант"]'),
        ('командир отделения', '["курсант"]'),
        ('командир взвода', '["офицер"]'),
        ('психолог', '["офицер", "работник"]'),
        ('специалист по учебно-методической работе', '["работник"]'),
        ('юрисконсульт', '["офицер", "работник"]'),
        ('научный сотрудник', '["офицер", "работник"]'),
        ('старший научный сотрудник', '["офицер", "работник"]'),
        ('старший психолог', '["офицер"]')
    ]
    try:
        результат = выполнить_запрос("SELECT COUNT(*) as count FROM должности")
        if результат and результат[0]['count'] > 0:
            logger.info("Справочник должностей уже заполнен")
            return
        for наименование, категории in должности:
            выполнить_запрос(
                "INSERT INTO должности (наименование, категории) VALUES (?, ?)",
                (наименование.lower(), категории)
            )
        logger.info("Справочник должностей успешно заполнен")
    except Exception as e:
        logger.error(f"Ошибка при заполнении справочника должностей: {e}")
        raise
